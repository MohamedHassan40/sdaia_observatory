data = [
    {
        "categoryColumns": ["Middle East", "High income", "Middle East & North Africa"],
        "filter": "Middle East",
        "geo_region_key": "SAU",
        "id": "SAU",
        "label": "Saudi Arabia",
        "metadata": [],
        "numericColumns": ["15", "145", "18", "4.033335209", "0.5006899238", "801.1112209", "22.2837925", "0.00250607729", "0.008378584869", "90094.46875", "301213.4375", "1945.948083", "54.12869673", "209.6463404", "5.831544676", "25188.18767", "700.63728", "372", "0.5223199725", "351065112576", "1", "0.02781610563", "1", "0.02781610563", "313318", "8715.287109", "6625", "184.2816925", "24", "0.06675864756", "10170.95303", "282.9162903", "60895.32729", "1693.87085", "1", "0.02781610563", "73", "0.5352187753", "680.7", "2.08", "18695.94173", "672126508709", "44339.31263", "30.593", "35950396", "27.754", "5.625", "15150.82085", "", "15683138", "", "6", "0.1668966264", "55253.04", "1536.924438", "120849901", "179802.3176", "13793427", "20522.06961", "86.55", "100", "100", "126.3611144", "20000000000", "29756302.93", "10", "10", "12.87229054", "0.3580569923", "", "1293.903212", "1402.6", "218.8579739", "198.1015873", "35.99134827", "39.01486588", "6.087776661", "5.5104146", "0", "2057214678", "3060755.22", "260", "7.232187271", "25087983.88", "4", "987583023", "1469341.005", "84", "2.336552858", "12661320.81", "1", "36.822", "46.01715", "2", "0", "1", "19.37914013", "2", "2", "0", "1", "1", "1", "0", "1", "1", "2"],
        "short_label": "SAU"
    }, {
        "categoryColumns": ["region", "CONTEXT: Income group", "CONTEXT: Region"],
        "filter": "region",
        "geo_region_key": "code",
        "id": "code",
        "label": "country",
        "metadata": [],
        "numericColumns": ["TALENT: Coursera Data Science score", "TALENT: Stack Overflow Questions related to AI", "TALENT: Stack Overflow Answers to AI related Questions", "TALENT: Stack Overflow Questions related to AI per capita", "TALENT: Stack Overflow Answers to AI related Questions per capita", "TALENT: Contributions to All Open Source AI repositories on GitHub", "TALENT: Contributions to All Open Source AI repositories on GitHub per capita", "TALENT: Number of IT Graduates per capita", "TALENT: Number of STEM Graduates per capita", "TALENT: Number of IT Graduates", "TALENT: Number of STEM Graduates", "TALENT: Existing number of Data Scientists and Engineers", "TALENT: Number of Data Scientists and Engineers per capita", "TALENT: Existing number of AI professionals", "TALENT: Number of AI professionals per capita", "RESEARCH: Number of STEM researchers", "RESEARCH: Number of STEM researchers per capita", "RESEARCH: Max Rank on Computer Science H-Index", "RESEARCH: R&D Spend proportional to GDP", "RESEARCH: Total R&D Spend", "RESEARCH: Number of Significant Machine Learning Systems developed", "RESEARCH: Number of Significant Machine Learning Systems developed per capita", "RESEARCH: Number of Authors of Significant Machine Learning Systems", "RESEARCH: Number of Authors of Significant Machine Learning Systems per capita", "RESEARCH: Number of Computer Science Paper Citations", "RESEARCH: Number of Computer Science Paper Citations per capita", "RESEARCH: Number of AI Articles by top Computer Science academics", "RESEARCH: Number of AI Articles by top Computer Science per capita", "RESEARCH: Number of Submissions to AI Conferences", "RESEARCH: Number of Submissions to AI Conferences per capita", "RESEARCH: Number of AI Related Papers", "RESEARCH: Number of AI Related Papers Per Capita", "RESEARCH: Number of Citations on AI Related Papers", "RESEARCH: Number of Citations on AI Related Papers Per Capita", "RESEARCH: Number of Universities in Times Higher Education Top 100 Computer Science Universities", "RESEARCH: Number of Universities in Times Higher Education Top 100 Computer Science Universities per capita", "OPERATING ENVIRONMENT: Proportion of Population that Trusts AI", "OPERATING ENVIRONMENT: Proportion of Population who think AI is more helpful than harmful", "OPERATING ENVIRONMENT: Cost of Visa", "CONTEXT: Economist Democracy Score", "CONTEXT: GDP per capita", "CONTEXT: GDP (Billions)", "CONTEXT: GDP (Purchasing Parity Power)", "CONTEXT: Gross national savings (% of GDP)", "CONTEXT: Population (millions)", "CONTEXT: Total investment (% of GDP)", "CONTEXT: Unemployment rate (% of population)", "CONTEXT: Annual Income", "CONTEXT: Cost of Living Index", "CONTEXT: Total Labour Force", "CONTEXT: Median Age", "INFRASTRUCTURE: Number of Large Non-Distributed Super Computers", "INFRASTRUCTURE: Number of Large Non-Distributed Super Computers per capita", "INFRASTRUCTURE: Total flops of Large Non-Distributed Super Computers per Capita", "INFRASTRUCTURE: Total flops of Large Non-Distributed Super Computers per Capita", "INFRASTRUCTURE: Proportion of Total Integrated Circuits Imports", "INFRASTRUCTURE: Proportion of Total Integrated Circuits Imports", "INFRASTRUCTURE: Proportion of Total Integrated Circuits Exports", "INFRASTRUCTURE: Proportion of Total Integrated Circuits Exports", "INFRASTRUCTURE: Average Download Speed", "INFRASTRUCTURE: Proportion of Population using Internet", "INFRASTRUCTURE: Proportion of Population with Access to Electricity", "INFRASTRUCTURE: Mobile Penetration Rate per 100 persons", "GOVERNMENT STRATEGY: Dedicated Spending on Artificial Intelligence", "GOVERNMENT STRATEGY: Dedicated Spending on Artificial Intelligence proportional to GDP", "GOVERNMENT STRATEGY: Spend Period of Dedicated AI Budgets", "GOVERNMENT STRATEGY: Time Scale of Dedicated Strategy", "DEVELOPMENT: Github contributions to High-Popularity Open Source AI Packages", "DEVELOPMENT: Github contributions to High-Popularity Open Source AI Packages per capita", "DEVELOPMENT: Average days taken for approval by patent office", "DEVELOPMENT: Number of Filed AI Patents by applicant", "DEVELOPMENT: Number of Filed AI Patents by inventor", "DEVELOPMENT: Number of Granted AI Patents by applicant", "DEVELOPMENT: Number of Granted AI Patents by inventor", "DEVELOPMENT: Number of Filed 'AI Patents' by applicant per capita", "DEVELOPMENT: Number of Filed 'AI Patents' by inventor per capita", "DEVELOPMENT: Granted patents by applicants per capita", "DEVELOPMENT: Granted patents by inventors per capita", "COMMERCIAL: Businesses self-reporting using Artificial Intelligence (%)", "COMMERCIAL: Total Funding of AI Companies", "COMMERCIAL: Total Funding of AI Companies proportional to GDP", "COMMERCIAL: Number of AI Companies", "COMMERCIAL: Number of AI Companies per capita", "COMMERCIAL: Average Funding of AI Company", "COMMERCIAL: Number of Listed AI Companies", "COMMERCIAL: Total Funding of AI Startups", "COMMERCIAL: Total Funding of AI Startups", "COMMERCIAL: Number of AI Startups", "COMMERCIAL: Number of AI Startups per capita", "COMMERCIAL: Average Startup Funding", "COMMERCIAL: Number of AI Unicorns", "OPERATING ENVIRONMENT: Gender Diversity of Science Graduates", "OPERATING ENVIRONMENT: Gender Diversity of IT Graduates", "OPERATING ENVIRONMENT: Level of Data Protection Regulation", "OPERATING ENVIRONMENT: Presence of Right to Explanation", "OPERATING ENVIRONMENT: Open Data Charter", "OPERATING ENVIRONMENT: Kapersky Cybersecurity Score", "OPERATING ENVIRONMENT: Level of Participation of ISO AI Committee", "GOVERNMENT STRATEGY: Government has Dedicated AI Strategy", "GOVERNMENT STRATEGY: Government has Dedicated AI Minister", "GOVERNMENT STRATEGY: Government has Dedicated AI governmental body", "GOVERNMENT STRATEGY: Government has Publically Dedicated Money to AI", "GOVERNMENT STRATEGY: Government has Measurable AI Targets", "GOVERNMENT STRATEGY: Tracking of Previous Years efforts on AI", "GOVERNMENT STRATEGY: Dedicated Strategy received External Consultation", "GOVERNMENT STRATEGY: Dedicated Strategy mentions Training or upskilling", "GOVERNMENT STRATEGY: Dedicated Strategy was Signed by Senior Member of Government"],
        "short_label": "code"
    }
]


column_names = data[1]['numericColumns']
column_values = data[0]['numericColumns']
country_name = data[0]['short_label']

# Create an array of objects
result = []
for index in range(len(column_names)):
    result.append({
        "Country_name": country_name,
        "Column_name": column_names[index],
        "Column_value": column_values[index]
    })

# Print the result
with open('output.json', 'w') as f:
    f.write(str(result))


def linkedindate_to_iso_date(date_str):
    # {'year': 2022, 'month': 6, 'day': 0}
    try:
        year = date_str.get('year', 2000)
        month = date_str.get('month', 1)
        day = date_str.get('day', 1)
        if day == 0 and month == 0 and year == 0:
            return None

        if day == 0:
            day = 1
        if month == 0:
            month = 1
        if year == 0:
            year = 2001

        if year:
            return f"{year}-{month}-{day}"
        else:
            return None
    except Exception as e:
        print(f"Failed to parse date '{date_str}': {str(e)}")
        return None


def correctSingleQuoteJSON(s):
    rstr = ""
    escaped = False

    for c in s:
    
        if c == "'" and not escaped:
            c = '"' # replace single with double quote
        
        elif c == "'" and escaped:
            rstr = rstr[:-1] # remove escape character before single quotes
        
        elif c == '"':
            c = '\\' + c # escape existing double quotes
   
        escaped = (c == "\\") # check for an escape character
        rstr += c # append the correct json
    
    return rstr